package com.dns.taxchina.ui;import netlib.util.PhoneUtil;import android.view.View;import android.webkit.WebView;import android.widget.ImageView;import android.widget.TextView;import android.widget.Toast;import com.dns.taxchina.R;import com.dns.taxchina.service.db.CollectDBUtil;import com.dns.taxchina.service.model.BaseItemModel;import com.dns.taxchina.ui.widget.WebViewPlug;import com.dns.taxchina.ui.widget.WebViewPlug.LoadWebViewListener;/** * @author henzil * @version create time:2014-4-24_下午5:31:39 * @Description 详情页 */public class DetailActivity extends BaseActivity {	private WebView webView;	protected WebViewPlug plug;	private String url = "file:///android_asset/index.html";	private BaseItemModel model;	private boolean isCollected;	private ImageView star;	private TextView back;	private CollectDBUtil collectUtil = null;	public static final String DETAIL_MODEL = "detail_model";	@Override	protected void initData() {		collectUtil = CollectDBUtil.getInstance(DetailActivity.this, PhoneUtil.getIMEI(DetailActivity.this));		plug = new WebViewPlug(this);		model = (BaseItemModel) getIntent().getSerializableExtra(DETAIL_MODEL);		url = model.getUrl();	}	@Override	protected void initViews() {		setContentView(R.layout.activity_detail);		back = (TextView) findViewById(R.id.back_text);		star = (ImageView) findViewById(R.id.collection_btn);		webView = (WebView) findViewById(R.id.web_view);		plug.webViewPlug(url, webView, model);		if (collectUtil.isExistCourse(model.getId())) {			star.setImageResource(R.drawable.collection_h);			isCollected = true;			// update			collectUtil.saveCourse(model);		} else {			star.setImageResource(R.drawable.collection_n);			isCollected = false;		}	}	@Override	protected void initWidgetActions() {		back.setOnClickListener(new View.OnClickListener() {			@Override			public void onClick(View v) {				finish();			}		});		star.setOnClickListener(new View.OnClickListener() {			@Override			public void onClick(View v) {				if (isCollected) {					collectUtil.removeCourse(model.getId());					star.setImageResource(R.drawable.collection_n);					Toast.makeText(DetailActivity.this, getString(R.string.cancel_collect_success), Toast.LENGTH_SHORT).show();				} else {					collectUtil.saveCourse(model);					star.setImageResource(R.drawable.collection_h);					Toast.makeText(DetailActivity.this, getString(R.string.collect_success), Toast.LENGTH_SHORT).show();				}				isCollected = !isCollected;			}		});		plug.setLoadWebViewListener(new LoadWebViewListener() {			@Override			public void onPageFinished() {			}			@Override			public void onPageError() {			}		});	}}